var TcHmi;!function(e){!function(t){!function(o){o.SubjectInfosWithDialogs=[t.BA.SubjectInfos.HtgCrv,t.BA.SubjectInfos.HeatgCrv,t.BA.SubjectInfos.SpTRm,t.BA.SubjectInfos.SpRoomTemp],e.EventProvider.register(t.TcHmiBaEvents.onStartInitializing,(e=>{e.destroy(),o.Controls.Keyboard.initLayouts(),o.Controls.Keyboard.updateLayout(),o.Controls.Keyboard.initKeyboard(),i()}));let n,i=()=>{e.EventProvider.register(t.Server.BaSite.Events.onExtensionLoaded,(async o=>{try{o.destroy();const n=await t.Storage.UserData.loadLastThemeAsync();let a=!0;if(null!=n){e.Theme.get()===n?a=!1:e.Theme.set(n)}let r=e.EventProvider.register(t.TcHmiEvents.onThemeDataChanged,(async()=>{try{a?a=!1:t.Storage.UserData.saveLastThemeAsync(e.Theme.get())}catch(e){t.BaseError.warn(e)}}));e.EventProvider.register("onWebSocketClosed",(e=>{e.destroy(),r(),i()}))}catch(e){t.BaseError.warn(e)}}))};!function(n){let i;!function(n){let i,a,r="BaKeyboardGlobal";function l(n){setTimeout((n=>{if(null==i)return;if(e.BuildingAutomation.Helper.Keyboard.isMobile())return;let a=e.Config.get().systemKeyboard;if(null!=a&&""!==a.providerName&&n!==("Visible"===i.getVisibility()))if($("div#"+r).length<=0&&$("body").append(i.getElement()),n){let e=$(window).width()||"0",n=$(window).height()||"0",a=o.Keyboard.InputType===t.DataType.string?"780px":"400px";i.getElement().css("--ba-width-window",e+"px"),i.getElement().css("--ba-height-window",n+"px"),i.getElement().css("--ba-width-kb",a),i.setVisibility("Visible")}else i.setVisibility("Collapsed")}),10,n)}n.ZIndex=o.OverlayContainerZIndex+1e3,n.initKeyboard=function(){if(null!=i)return;let a=e.View.get();null!=a&&(i=e.Controls.get(r),null==i&&(i=e.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiKeyboard","BaKeyboardGlobal",null,a)),null!=i&&(t.Helper.DragableElement.makeDragable(i.getElement()),i.getElement().addClass("ba-kb-gl"),i.setScaleMode("ScaleToFill"),i.setVisibility("Collapsed"),i.setZindex(n.ZIndex),i.setLayoutFile(t.Helper.Keyboard.getLayoutPath()),e.EventProvider.register(t.TcHmiEvents.onLocaleChanged,(()=>{null!=i&&i.setLayoutFile(t.Helper.Keyboard.getLayoutPath())})),e.EventProvider.register(e.BuildingAutomation.Components.InputBox.InputBoxEvents.onFocusIn,((n,...a)=>{if(!(a[0]instanceof e.BuildingAutomation.Components.InputBox))return;let r=a[0];r.getUsedDataType()!=o.Keyboard.InputType&&(o.Keyboard.InputType=r.getUsedDataType()||t.DataType.string,null!=i&&i.setLayoutFile(t.Helper.Keyboard.getLayoutPath())),l(!0)})),e.EventProvider.register(e.BuildingAutomation.Components.InputBox.InputBoxEvents.onFocusOut,((e,...t)=>{l(!1)})),e.EventProvider.register(e.BuildingAutomation.Components.InputBox.InputBoxEvents.onUserInteractionFinished,((e,...t)=>{l(!1)}))))},n.initLayouts=function(){a=new Map([["de",o.Locale.KBLayout.German],["de-de",o.Locale.KBLayout.German],["en",o.Locale.KBLayout.US],["en-us",o.Locale.KBLayout.US]])},n.updateLayout=function(){let t=e.Locale.get();if(o.Keyboard.Layout=o.Locale.KBLayout.US,null!=t){let e=a.get(t.toLowerCase());null!=e&&(o.Keyboard.Layout=e)}},n.setVisibilityKeyboard=l}(i=n.Keyboard||(n.Keyboard={}))}(n=o.Controls||(o.Controls={}))}(t.Globals||(t.Globals={}))}(e.BuildingAutomation||(e.BuildingAutomation={}))}(TcHmi||(TcHmi={}));